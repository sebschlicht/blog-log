# IPv6 and internet lite

Perhaps you are old. As am I.

Perhaps you were using some sort of dynamic DNS service to route traffic to your router using a fancy name.
A router that was happily routing that traffic to selected devices in your home network just by looking at the destination port (NAT).

Well, the future is now, old man.

Your internet service provider switched to a DS lite stack and all your router can do is publish its IPv6 address prefix?
Meanwhile all you know about IPv6 is that it addresses the address exhaustion of IPv4?

I've been there. Let me reach you a hand by sharing my understanding.

## IPv6

IPv6 indeed addresses the address exhaustion.

An IPv6 address is 128 bit long and usually represented as 8 groups of 4 hexadecimal characters separated by colons.
Each group may be shortened by omitting leading zeros and representing consecutive all-zero blocks as `::`.
For our address type, the first half is the network component (IPv6 prefix), the second half the node component (interface ID).

The network component is determined by your router via router advertisement (RA).
Depending on your ISP, this prefix might change on a daily basis, from one random value to another.

The node component is generated by the network device the address will point at.
To avoid making tracking users as simple as taking this 64 bit node component of a user|s IPv6 address, the generated node component is by default (1) rather random and (2) temporary.

As you can see, IPv6 addresses are great to protect your privacy and rather cumbersome if you are trying to make a service reachable at your domain.

## DS lite stack

With IPv6 and increasingly few IPv4 addresses at hand, your ISP might have chosen to go with a DS lite stack.
Your router would be reachable via IPv6 but not IPv4. Basically, you have to deal with IPv6 one way or the other now.

That's about as much as I know about DS lite, didn't give it too much effort.

## Dynamic DNS

TBD.

## Static interface ID

To get a deterministic IPv6 address, you can set a static token for the interface ID generation of your network device.
In this example, I'll be using the device `wlp0s20f3`.

A static token can only be set when router advertisement is enabled for that network device.
Check if it's currently enabled, otherwise enable it:

    sysctl net.ipv6.conf.wlp0s20f3.accept_ra
    # 0 = disabled, 1 = enabled, 2 = enforced
    sudo sysctl net.ipv6.conf.wlp0s20f3.accept_ra=1

Then set a static token (interface ID), here `::1` (short for  `0:0:0:1`):

    sudo ip token set ::1/64 dev wlp0s20f3
